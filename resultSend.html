<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>è³‡æ–™é€å‡ºä¸­...</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
    body {
        font-family: Arial, "Microsoft JhengHei";
        background: #f2f2f2;
        text-align: center;
        padding: 40px;
        font-size: 22px;
    }
</style>
</head>

<body>
<p>ğŸ“¤ æ­£åœ¨è™•ç†æ‚¨çš„é è¨‚ï¼Œè«‹ç¨å€™â€¦</p>

<script>
/* â˜…â˜…â˜… ä½ çš„ GAS API â˜…â˜…â˜… */
const API_URL =
 "https://script.google.com/macros/s/AKfycbz5HEyUZi1MskWO4LRaEuBUfU03KX_9QxCI4DgcDcI7PwXB8J3tpV6GKZoJoNzuwjb7/exec";

(async () => {

    /* ----------------------------------------------------
       åˆå§‹åŒ– LIFF
    ---------------------------------------------------- */
    await liff.init({ liffId: "2008409020-k4Oy7Y0D" });

    if (!liff.isLoggedIn()) {
        liff.login();
        return;
    }

    /* ----------------------------------------------------
       å–å¾— URL å‚³å…¥åƒæ•¸
    ---------------------------------------------------- */
    const url = new URL(location.href);

    const house = url.searchParams.get("house");
    const date = url.searchParams.get("date");
    const days = url.searchParams.get("days");
    const name = url.searchParams.get("name");
    const phone = url.searchParams.get("phone");
    const adult = url.searchParams.get("adult");
    const child = url.searchParams.get("child");
    const pet   = url.searchParams.get("pet");
    const note  = url.searchParams.get("note") || "";

    /* ----------------------------------------------------
       å¯«å…¥ Google Sheetï¼ˆGASï¼‰
    ---------------------------------------------------- */
    const body = {
        action: "add",
        admin_key: "admin2025",
        house,
        date,
        days,
        name,
        phone,
        adult,
        child,
        pet,
        note
    };

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify(body)
    });

    /* ----------------------------------------------------
       å›å‚³è¨Šæ¯çµ¦ä½¿ç”¨è€…
    ---------------------------------------------------- */
    const msg =
`ğŸ“˜ æ‚¨çš„é è¨‚å·²æ”¶åˆ°ï¼

ğŸ¡ é¤¨åˆ¥ï¼š${house}
ğŸ“… åŒ…æ£Ÿæ—¥æœŸï¼š${date}
ğŸŒ™ åŒ…æ£Ÿå¤©æ•¸ï¼š${days} æ™š
ğŸ§‘â€ğŸ§‘â€ğŸ§’ å¤§äººï¼š${adult} ä½
ğŸ§’ å°å­©ï¼š${child} ä½
ğŸ¶ å¯µç‰©ï¼š${pet}
ğŸ“ å‚™è¨»ï¼š${note || "ç„¡"}

æˆ‘å€‘æœƒç›¡å¿«èˆ‡æ‚¨è¯ç¹«ï¼Œè¬è¬æ‚¨ï¼`;

    try {
        await liff.sendMessages([
            { type: "text", text: msg }
        ]);
    } catch (e) {
        console.error("è¨Šæ¯æ¨æ’­å¤±æ•—ï¼š", e);
    }

    /* ----------------------------------------------------
       é—œé–‰è¦–çª—
    ---------------------------------------------------- */
    liff.closeWindow();

})();
</script>

</body>
</html>
