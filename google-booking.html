<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>é–å¯¬ãƒ»ç·šä¸Šé è¨‚ï½œå®˜æ–¹é è¨‚é é¢</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
  body {
    margin: 0;
    font-family: "Noto Sans TC","Microsoft JhengHei", sans-serif;
    background: #f5f5f5;
    color: #333;
  }

  /* Hero Banner */
  .hero {
    background: url('https://source.unsplash.com/featured/?taiwan,homestay') center/cover no-repeat;
    height: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    text-shadow: 0 2px 8px rgba(0,0,0,0.4);
    font-size: 26px;
    font-weight: 900;
  }

  /* Section Card */
  .section {
    background: #fff;
    margin: 16px;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  }

  h2 {
    margin: 0 0 12px;
    font-size: 20px;
    font-weight: 900;
    color: #06c755;
  }

  p { 
    line-height: 1.6;
    font-size: 15px;
    margin-bottom: 10px;
  }

  /* Form Input */
  .field { margin-bottom: 16px; }
  .field label {
    display: block;
    margin-bottom: 6px;
    font-weight: 700;
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    font-size: 15px;
    border-radius: 10px;
    border: 1px solid #bbb;
    box-sizing: border-box;
  }
  textarea { resize: vertical; min-height: 70px; }

  /* Button */
  .btn {
    width: 100%;
    padding: 14px;
    background: #06c755;
    color: #fff;
    border: none;
    border-radius: 999px;
    font-size: 18px;
    font-weight: 900;
    cursor: pointer;
    margin-top: 10px;
  }

  .availability {
    margin-top: 4px;
    font-size: 14px;
  }
  .availability.ok { color: #2e7d32; }
  .availability.full { color: #d32f2f; }

  .room-photos {
    display: flex;
    gap: 10px;
    overflow-x: auto;
  }
  .room-photos img {
    height: 120px;
    border-radius: 12px;
    object-fit: cover;
  }

  /* Footer */
  footer {
    text-align: center;
    padding: 20px;
    font-size: 13px;
    color: #777;
    margin-top: 30px;
  }

</style>
</head>

<body>

<!-- Hero Banner -->
<div class="hero">é–å¯¬æ°‘å®¿ãƒ»ç·šä¸Šé è¨‚</div>

<!-- æˆ¿å‹ç…§ç‰‡ -->
<div class="section">
  <h2>ğŸ¡ æˆ¿é–“ç…§ç‰‡</h2>
  <div class="room-photos">
    <img src="https://source.unsplash.com/featured/?bedroom" />
    <img src="https://source.unsplash.com/featured/?hotel" />
    <img src="https://source.unsplash.com/featured/?room" />
  </div>
</div>

<!-- æˆ¿åƒ¹è³‡è¨Š -->
<div class="section">
  <h2>ğŸ’° æˆ¿åƒ¹è³‡è¨Š</h2>
  <p>ğŸ“Œ A é¤¨ï¼ˆ8â€“10 äººï¼‰NT$8,000 èµ·</p>
  <p>ğŸ“Œ B é¤¨ï¼ˆ12â€“15 äººï¼‰NT$10,000 èµ·</p>
  <p>ï¼Šå¯¦éš›åƒ¹æ ¼ä»¥ç®¡å®¶å›è¦†ç‚ºæº–</p>
</div>

<!-- é è¨‚è¡¨å–® -->
<div class="section">
  <h2>ğŸ“ ç·šä¸Šé è¨‚</h2>

  <form id="bookingForm">

    <div class="field">
      <label>å§“åï¼ˆå¿…å¡«ï¼‰</label>
      <input id="name" required>
    </div>

    <div class="field">
      <label>æ‰‹æ©Ÿï¼ˆå¿…å¡«ï¼‰</label>
      <input id="phone" maxlength="10" placeholder="0912345678" required>
    </div>

    <div class="field">
      <label>é¸æ“‡é¤¨åˆ¥</label>
      <select id="house">
        <option>Aé¤¨</option>
        <option>Bé¤¨</option>
      </select>
    </div>

    <div class="field">
      <label>å…¥ä½æ—¥æœŸ</label>
      <input id="date" type="date" required>
      <div id="availabilityHint" class="availability"></div>
    </div>

    <div class="field">
      <label>ä½å®¿å¤©æ•¸</label>
      <select id="nights">
        <option value="1">1 æ™š</option>
        <option value="2">2 æ™š</option>
        <option value="3">3 æ™š</option>
      </select>
    </div>

    <div class="field">
      <label>å¤§äººäººæ•¸</label>
      <select id="adult">
        <option>2</option><option>3</option><option>4</option>
        <option>5</option><option>6</option><option>7</option>
      </select>
    </div>

    <div class="field">
      <label>å°å­©æ•¸</label>
      <select id="child">
        <option>0</option><option>1</option><option>2</option>
      </select>
    </div>

    <div class="field">
      <label>å¯µç‰©</label>
      <input id="pet" placeholder="ç„¡ / 1 éš»ç‹—">
    </div>

    <div class="field">
      <label>å‚™è¨»</label>
      <textarea id="note"></textarea>
    </div>

    <button class="btn" id="submitBtn">é€å‡ºé è¨‚</button>

  </form>
</div>

<!-- Google Map -->
<div class="section">
  <h2>ğŸ“ åœ°é»</h2>
  <iframe
    width="100%"
    height="200"
    frameborder="0"
    style="border-radius: 12px;"
    src="https://www.google.com/maps/embed/v1/place?key=AIzaSyD_FAKE_KEY&q=Sun+Moon+Lake"
    allowfullscreen>
  </iframe>
</div>

<footer>Â© 2025 é–å¯¬æ°‘å®¿ â€” ç·šä¸Šé è¨‚ç³»çµ±</footer>

<script>
const API_URL =
  "https://script.google.com/macros/s/AKfycbxAhWFD3rLv2O1RSnmEA3EJjXIK5vFKja4IHGtL8EW3q-6ZD77K1Emc_ryFAK1fOZKA/exec";

const dateInput = document.getElementById("date");
const houseInput = document.getElementById("house");
const nightsInput = document.getElementById("nights");
const availabilityHint = document.getElementById("availabilityHint");

/* æœ€å°å…¥ä½æ—¥ */
(function(){
  const t=new Date();
  const y=t.getFullYear();
  const m=String(t.getMonth()+1).padStart(2,"0");
  const d=String(t.getDate()).padStart(2,"0");
  dateInput.min=`${y}-${m}-${d}`;
})();

/* æŸ¥æˆ¿æ³ */
async function checkRoom(){
  if(!dateInput.value) return;
  const d=new Date(dateInput.value);
  const year=d.getFullYear();
  const month=d.getMonth()+1;

  try{
    const res=await fetch(`${API_URL}?action=getCalendar&house=${houseInput.value}&year=${year}&month=${month}`);
    const json=await res.json();

    const full=json.fullDates||[];
    let conflict=false;

    for(let i=0;i<nightsInput.value;i++){
      const dt=new Date(dateInput.value);
      dt.setDate(dt.getDate()+i);
      if(full.includes(dt.toISOString().split("T")[0])) conflict=true;
    }

    if(conflict){
      availabilityHint.textContent="âš  å·²å®¢æ»¿";
      availabilityHint.className="availability full";
    } else {
      availabilityHint.textContent="âœ“ å¯é è¨‚";
      availabilityHint.className="availability ok";
    }

  } catch {
    availabilityHint.textContent="ç„¡æ³•æŸ¥è©¢æˆ¿æ³";
  }
}
houseInput.addEventListener("change",checkRoom);
dateInput.addEventListener("change",checkRoom);
nightsInput.addEventListener("change",checkRoom);

/* é€å‡ºé è¨‚ */
document.getElementById("bookingForm").addEventListener("submit", async(e)=>{
  e.preventDefault();

  const name=document.getElementById("name").value.trim();
  const phone=document.getElementById("phone").value.trim();

  if(!/^09\d{8}$/.test(phone)){
    alert("æ‰‹æ©Ÿæ ¼å¼ä¸æ­£ç¢ºï¼ˆ09xxxxxxxxï¼‰");
    return;
  }

  const payload = {
    action:"createBooking",
    uid:"",
    name, phone,
    email:"",
    house:houseInput.value,
    date:dateInput.value,
    nights:nightsInput.value,
    adult:document.getElementById("adult").value,
    child:document.getElementById("child").value,
    pet:document.getElementById("pet").value,
    note:document.getElementById("note").value
  };

  try{
    const res=await fetch(API_URL,{
      method:"POST",
      body:JSON.stringify(payload)
    });
    const json=await res.json();

    if(!json.success) throw new Error(json.error);

    alert(`é è¨‚æˆåŠŸï¼${name}ï¼Œç¨å¾Œå°‡ç”±ç®¡å®¶èˆ‡æ‚¨ç¢ºèªã€‚`);
    location.href="google-booking.html";

  } catch(err){
    alert("é è¨‚å¤±æ•—ï¼š" + err.message);
  }
});
</script>
</body>
</html>
